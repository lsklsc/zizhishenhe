webpackJsonp([5],{alzj:function(e,t){},uxAk:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Gu7T"),i=a.n(r),l=a("Dd8w"),o=a.n(l),s=a("hYS1"),n=a("o5Dg"),c={components:{upload:s.a},data:function(){return{role_type:"",company_id:"",pickerOptions1:{disabledDate:function(e){var t=(new Date).getFullYear(),a=(new Date).getMonth(),r=(new Date).getDate(),i=new Date(t,a,r,"23","59","59").getTime();return e.getTime()>i}},files:"",rules:{name:[{required:!0,message:"请输入姓名",trigger:"blur"}],phone:[{required:!0,message:"请输入联系方式",trigger:"blur"}],job:[{required:!0,message:"请填写职务",trigger:"blur"}],sex:[{required:!0,message:"请填写性别",trigger:"blur"}],age:[{required:!0,message:"请填写年龄",trigger:"blur"}],service_area:[{required:!0,message:"请选择服务区域",trigger:"blur"}]},selectList:[{job:"职工",label:"职工"},{job:"组长",label:"组长"},{job:"部长",label:"部长"},{job:"经理",label:"经理"}],serviceList:[],dialogVisible:!1,dialogVisible1:!1,imgDialogVisible:!1,dialogTitle:"",pickerOptions:{disabledDate:function(e){return e.getTime()>new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1)}},pickerOptions0:{disabledDate:function(e){return e.getTime()<Date.now()-864e5}},ruleForm:{},tableData:[],searchData:{name:"",job:"",operater:"",phone:""},date1:[],date2:[],date3:[],pageData:{page:1,page_size:10},total:0,activeParams:"0",isButton0:!0,isButton1:!0,isButton2:!0,isButton3:!0,no_reject:!1,lookObj:{},recordList:[],oldruleForm:{},imgList:[]}},methods:{httpRequest:function(e){var t=this,a=new FormData;a.append("file",e.file),a.append("company_id",this.company_id),n.a.importStaff(a).then(function(e){200==e.data.code?(t.$message.success(e.data.msg),t.personList()):208==e.data.code?t.$message.warning(e.data.msg):t.$message.error(e.data.msg)})},exportTable:function(){var e=this;this.$confirm("本次共导出"+this.total+"条数据是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var t={data:o()({company_id:e.company_id,page:e.pageData.page,size:e.pageData.page_size,start_create_time:e.date1[0],end_create_time:e.date1[1],start_enter_time:e.date3[0],end_enter_time:e.date3[1],start_submit_time:e.date2[0],end_submit_time:e.date2[1],status:e.activeParams},e.searchData),api:"personData",total:e.total};e.$refs.export.exportlist(t)}).catch(function(){e.$message({type:"info",message:"已取消导出"})})},importClick:function(){var e=document.createElement("a");e.style.display="none",e.href="http://filemanager.ztbory.com/v1/file/filedownload/?bucket=qualification&path=20210316&filename=9efe4373aa484a5f974f95e4cd4e437c.xlsx",e.setAttribute("download","资质模板"),document.body.appendChild(e),e.click()},tabClick:function(e){"0"===e.name&&(this.isButton0=!0,this.isButton1=!0,this.isButton2=!0,this.isButton3=!0,this.no_reject=!1,this.personList()),"1"===e.name&&(this.isButton0=!0,this.isButton1=!1,this.isButton2=!1,this.isButton3=!1,this.no_reject=!1,this.personList()),"2"===e.name&&(this.isButton0=!0,this.isButton1=!1,this.isButton2=!0,this.isButton3=!0,this.licensed_content=!1,this.no_reject=!0,this.personList()),"3"===e.name&&(this.isButton0=!0,this.isButton1=!1,this.isButton2=!0,this.isButton3=!0,this.no_reject=!1,this.personList())},submitClick:function(e){var t=this;console.log(e),e.job_picture?this.$confirm("确认提交, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var a={status:1,worker_id:e.worker_id,company_id:t.company_id};n.a.submitPerson(e.id,a).then(function(e){0==e.data.code?(t.$message.success("提交成功!"),t.personList()):t.$message.error(e.data.msg)})}).catch(function(){t.$message.info("已取消提交")}):this.$message.warning("请完善人员信息")},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(t.ruleForm.job_picture){if(!e)return console.log("error submit!!"),!1;if(t.ruleForm.id){console.log(t.ruleForm,11);var a={status:t.ruleForm.status,worker_id:t.ruleForm.worker_id};for(var r in t.ruleForm)for(var i in t.oldruleForm)r==i&&t.ruleForm[r]!=t.oldruleForm[i]&&(console.log(r),a[r]=t.ruleForm[r]);n.a.redactPerson(t.ruleForm.id,a).then(function(e){0==e.data.code?(t.$message.success("编辑成功!"),t.personList(),t.dialogVisible1=!1):t.$message.error(e.data.msg)})}else n.a.addPerson(t.ruleForm).then(function(e){0==e.data.code?(t.$message.success("新增成功!"),t.personList(),t.dialogVisible1=!1):t.$message.error(e.data.msg)})}else t.$message.warning("请上传合同照片")})},handleClose:function(e){this.$refs.ruleForm.resetFields(),this.$refs.upload.clearFiles(),this.ruleForm={},this.ruleForm.company_id=this.company_id},addClk:function(){this.dialogTitle="新建",this.dialogVisible1=!0,this.imageUrl=""},updataClick:function(e){console.log(e),this.dialogTitle="修改",this.dialogVisible1=!0,this.oldruleForm=o()({},e),this.ruleForm=o()({},e)},deleteClick:function(e){var t=this;console.log(e);var a={status:e.status,worker_id:e.worker_id};this.$confirm("此操作将永久删除, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.a.delPerson(e.id,a).then(function(e){t.$message.success("删除成功!"),t.personList()})}).catch(function(){t.$message.info("已取消删除")})},lookClick:function(e){var t=this;this.imgList=[].concat(i()((e.job_picture||"").split(","))),this.dialogVisible=!0,this.lookObj=e;var a={status:e.status,worker_id:e.worker_id};n.a.recordPerson(a).then(function(e){0==e.data.code&&(t.recordList=e.data.data)})},lookImgClick:function(e){this.imgDialogVisible=!0,this.imgList=[].concat(i()((e.job_picture||"").split(",")))},handleSizeChange:function(e){this.pageData.page_size=e,this.personList()},handleCurrentChange:function(e){this.pageData.page=e,this.personList()},uploadSuccess:function(e){this.ruleForm.job_picture=e.join(",")},searchClk:function(){this.pageData.page=1,this.personList()},resetClk:function(){this.pageData.page=1,this.pageData.page_size=10,this.date1=[],this.date2=[],this.date3=[],this.searchData={},this.personList()},personList:function(){var e=this,t=o()({company_id:this.company_id,page:this.pageData.page,size:this.pageData.page_size,start_create_time:this.date1[0],end_create_time:this.date1[1],start_enter_time:this.date3[0],end_enter_time:this.date3[1],start_submit_time:this.date2[0],end_submit_time:this.date2[1],status:this.activeParams},this.searchData);n.a.personData(t).then(function(t){200==t.data.code&&(e.tableData=t.data.data.data.results,e.total=t.data.data.data.count)})},serviceData:function(){var e=this,t={company_id:this.company_id};n.a.quCheZizhiData(t).then(function(t){0==t.data.code&&(console.log(t),e.serviceList=t.data.data.data)})}},mounted:function(){var e=localStorage.getItem("userInfo"),t=JSON.parse(e);this.ruleForm.company_id=t.company_id,this.company_id=t.company_id,this.role_type=t.role_type,this.serviceData(),this.personList()}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content"},[a("el-tabs",{on:{"tab-click":e.tabClick},model:{value:e.activeParams,callback:function(t){e.activeParams=t},expression:"activeParams"}},[a("el-tab-pane",{attrs:{label:"草稿",name:"0"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"待处理",name:"1"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"不通过",name:"2"}}),e._v(" "),a("el-tab-pane",{attrs:{label:"已通过",name:"3"}})],1),e._v(" "),a("el-form",{attrs:{inline:""}},[a("el-form-item",{attrs:{label:"姓名："}},[a("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.searchData.name,callback:function(t){e.$set(e.searchData,"name",t)},expression:"searchData.name"}})],1),e._v(" "),"0"==e.activeParams?a("el-form-item",{attrs:{label:"保存日期"}},[a("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"],"picker-options":e.pickerOptions1,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.date1,callback:function(t){e.date1=t},expression:"date1"}})],1):e._e(),e._v(" "),"1"==e.activeParams?a("el-form-item",{attrs:{label:"提交日期"}},[a("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"],"picker-options":e.pickerOptions1,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.date2,callback:function(t){e.date2=t},expression:"date2"}})],1):e._e(),e._v(" "),"2"==e.activeParams?a("el-form-item",{attrs:{label:"审核日期"}},[a("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"],"picker-options":e.pickerOptions1,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.date3,callback:function(t){e.date3=t},expression:"date3"}})],1):e._e(),e._v(" "),"3"==e.activeParams?a("el-form-item",{attrs:{label:"通过日期"}},[a("el-date-picker",{attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"],"picker-options":e.pickerOptions1,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.date3,callback:function(t){e.date3=t},expression:"date3"}})],1):e._e(),e._v(" "),a("el-form-item",{attrs:{label:"职务："}},[a("el-input",{attrs:{placeholder:"请输入职务"},model:{value:e.searchData.job,callback:function(t){e.$set(e.searchData,"job",t)},expression:"searchData.job"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式："}},[a("el-input",{attrs:{placeholder:"请输入联系方式"},model:{value:e.searchData.phone,callback:function(t){e.$set(e.searchData,"phone",t)},expression:"searchData.phone"}})],1),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.searchClk}},[e._v("搜索")]),e._v(" "),"0"!=e.activeParams||"1"!=e.role_type&&"2"!=e.role_type?e._e():a("el-button",{attrs:{type:"primary"},on:{click:e.addClk}},[e._v("新建")]),e._v(" "),a("el-button",{staticClass:"margin",attrs:{type:"warning"},on:{click:e.resetClk}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.exportTable}},[e._v("导出")]),e._v(" "),a("el-form-item",[a("dataExport",{ref:"export",attrs:{filename:"人员管理",data:e.tableData}})],1),e._v(" "),"0"==e.activeParams?a("el-form-item",[a("el-upload",{attrs:{accept:".xls, .xlsx","show-file-list":!1,action:"string","http-request":e.httpRequest}},[a("el-button",{attrs:{type:"primary"}},[e._v("导入")])],1)],1):e._e(),e._v(" "),"0"==e.activeParams?a("el-form-item",[a("el-button",{attrs:{type:"success"},on:{click:e.importClick}},[e._v("下载导入模板")])],1):e._e()],1),e._v(" "),a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"",border:"",height:"62vh"}},[a("el-table-column",{attrs:{type:"index",label:"序号"}}),e._v(" "),"2"==e.activeParams?a("el-table-column",{attrs:{prop:"enter_time",label:"审核时间"}}):e._e(),e._v(" "),"0"==e.activeParams?a("el-table-column",{attrs:{prop:"create_time",label:"保存时间"}}):e._e(),e._v(" "),"1"==e.activeParams?a("el-table-column",{attrs:{prop:"submit_time",label:"提交时间"}}):e._e(),e._v(" "),"3"==e.activeParams?a("el-table-column",{attrs:{prop:"enter_time",label:"通过时间"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"人员姓名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"phone",label:"联系方式"}}),e._v(" "),a("el-table-column",{attrs:{prop:"job",label:"职务"}}),e._v(" "),a("el-table-column",{attrs:{prop:"age",label:"年龄"}}),e._v(" "),a("el-table-column",{attrs:{prop:"area_name",label:"服务区域"}}),e._v(" "),e.no_reject?a("el-table-column",{attrs:{prop:"no_reject",label:"不通过原因"}}):e._e(),e._v(" "),a("el-table-column",{attrs:{prop:"contacts",label:"劳动合同"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.lookImgClick(t.row)}}},[e._v("查看")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"200px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[!e.isButton0||"1"!=e.role_type&&"2"!=e.role_type&&"3"!=e.role_type?e._e():a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.lookClick(t.row)}}},[e._v("查看")]),e._v(" "),!e.isButton1||"1"!=e.role_type&&"2"!=e.role_type?e._e():a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.submitClick(t.row)}}},[e._v("提交")]),e._v(" "),!e.isButton2||"1"!=e.role_type&&"2"!=e.role_type?e._e():a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.updataClick(t.row)}}},[e._v("修改")]),e._v(" "),e.isButton3&&"1"==e.role_type?a("el-button",{staticStyle:{color:"red"},attrs:{type:"text"},on:{click:function(a){return e.deleteClick(t.row)}}},[e._v("删除")]):e._e()]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:e.dialogTitle,visible:e.dialogVisible1,"close-on-click-modal":!1,width:"50%"},on:{"update:visible":function(t){e.dialogVisible1=t},close:function(t){return e.handleClose("ruleForm")}}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"160px"}},[a("el-form-item",{attrs:{label:"人员姓名：",prop:"name"}},[a("el-input",{attrs:{width:"200px"},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"联系方式：",prop:"phone"}},[a("el-input",{model:{value:e.ruleForm.phone,callback:function(t){e.$set(e.ruleForm,"phone",t)},expression:"ruleForm.phone"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"职务：",prop:"job"}},[a("el-select",{attrs:{placeholder:"请选择职务"},model:{value:e.ruleForm.job,callback:function(t){e.$set(e.ruleForm,"job",t)},expression:"ruleForm.job"}},e._l(e.selectList,function(e){return a("el-option",{key:e.job,attrs:{label:e.label,value:e.job}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"性别：",prop:"sex"}},[a("el-input",{model:{value:e.ruleForm.sex,callback:function(t){e.$set(e.ruleForm,"sex",t)},expression:"ruleForm.sex"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"年龄：",prop:"age"}},[a("el-input",{attrs:{type:"number",oninput:"value=value.replace(/[^\\d]/g,'')"},model:{value:e.ruleForm.age,callback:function(t){e.$set(e.ruleForm,"age",e._n(t))},expression:"ruleForm.age"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"服务区域：",prop:"service_area"}},[a("el-select",{attrs:{placeholder:"请选择服务区域"},model:{value:e.ruleForm.service_area,callback:function(t){e.$set(e.ruleForm,"service_area",t)},expression:"ruleForm.service_area"}},e._l(e.serviceList,function(e){return a("el-option",{key:e.coding,attrs:{label:e.name,value:e.coding}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"合同照片："}},[a("upload",{ref:"upload",attrs:{imageUrl:e.ruleForm.job_picture},on:{uploadSuccess:e.uploadSuccess}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible1=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确定")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"详情",visible:e.dialogVisible,width:"50%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[e._v("人员姓名："+e._s(e.lookObj.name))]),e._v(" "),a("el-col",{attrs:{span:12}},[e._v("联系方式："+e._s(e.lookObj.phone))])],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[e._v("职务："+e._s(e.lookObj.job))]),e._v(" "),a("el-col",{attrs:{span:12}},[e._v("服务区域："+e._s(e.lookObj.area_name))])],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[e._v("性别："+e._s(e.lookObj.sex))]),e._v(" "),a("el-col",{attrs:{span:12}},[e._v("年龄："+e._s(e.lookObj.age))])],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:12}},[e._v("\n        劳动合同：\n        "),e._l(e.imgList,function(t){return a("el-image",{key:t,staticStyle:{width:"100px",height:"100px"},attrs:{src:t,"preview-src-list":e.imgList}},[a("div",{staticStyle:{"line-height":"100px"},attrs:{slot:"error"},slot:"error"},[e._v("\n            暂无图片\n          ")])])})],2)],1),e._v(" "),"2"==e.activeParams||"3"==e.activeParams?a("div",{staticClass:"recordTable"},[a("el-table",{ref:"table",staticStyle:{width:"100%"},attrs:{data:e.recordList,stripe:"",border:"",height:"26vh"}},[a("el-table-column",{attrs:{type:"index",label:"序号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:"时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"username",label:"修改人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"update_data",label:"修改项"}}),e._v(" "),a("el-table-column",{attrs:{prop:"old_content",label:"修改前"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.old_content.indexOf("http")>-1?a("div",{staticStyle:{display:"flex"}},e._l(t.row.old_content.split(","),function(e,r){return a("div",{key:r},[a("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e,"preview-src-list":t.row.old_content.split(",")}})],1)}),0):a("div",[e._v(e._s(t.row.old_content))])]}}],null,!1,2285074851)}),e._v(" "),a("el-table-column",{attrs:{prop:"new_content",label:"修改后"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.new_content.indexOf("http")>-1?a("div",{staticStyle:{display:"flex"}},e._l(t.row.new_content.split(","),function(e,r){return a("div",{key:r},[a("el-image",{staticStyle:{width:"50px",height:"50px"},attrs:{src:e,"preview-src-list":t.row.new_content.split(",")}})],1)}),0):a("div",[e._v(e._s(t.row.new_content))])]}}],null,!1,1125431811)})],1)],1):e._e(),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"劳动合同",visible:e.imgDialogVisible,width:"50%"},on:{"update:visible":function(t){e.imgDialogVisible=t}}},[e._l(e.imgList,function(t){return a("el-image",{key:t,staticStyle:{width:"100px",height:"100px"},attrs:{src:t,"preview-src-list":e.imgList}},[a("div",{staticStyle:{"line-height":"100px"},attrs:{slot:"error"},slot:"error"},[e._v("\n        暂无图片\n      ")])])}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.imgDialogVisible=!1}}},[e._v("取 消")])],1)],2),e._v(" "),a("div",{staticClass:"fenye"},[a("el-pagination",{attrs:{"current-page":e.pageData.page,"page-size":e.pageData.page_size,"page-sizes":[10,20,30,40],layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var p=a("VU/8")(c,u,!1,function(e){a("alzj")},"data-v-d9c1bc1e",null);t.default=p.exports}});
//# sourceMappingURL=5.ada90b41975fc11f0c0a.js.map