{"version":3,"sources":["webpack:///src/components/upload.vue","webpack:///./src/components/upload.vue?f8ac","webpack:///./src/components/upload.vue","webpack:///./node_modules/babel-runtime/core-js/json/stringify.js","webpack:///./node_modules/core-js/library/fn/json/stringify.js"],"names":["upload","props","imageUrl","type","String","default","mkdir","uploadLimit","Number","data","imageArr","urlString","dialogVisible","dialogImageUrl","action","watch","handler","newName","oldName","console","log","this","init","immediate","deep","mounted","common","methods","handlePictureCardPreview","file","url","clearFiles","$refs","onSuccess","response","fileList","urlArr","forEach","item","push","join","$emit","onRemove","arr","map","o","onExceed","$message","warning","onChange","header","Authorization","JSON","parse","localStorage","getItem","token","Content-Type","split","beforeAvatarUpload","size","error","components_upload","render","_vm","_h","$createElement","_c","_self","staticClass","ref","attrs","list-type","name","beforeUpload","on-preview","file-list","on-change","on-success","on-remove","limit","on-exceed","_v","visible","on","update:visible","$event","width","src","alt","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__","module","exports","__esModule","core","$JSON","stringify","it","apply","arguments"],"mappings":"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","file":"static/js/0.aeecdab0335fef5ecb4a.js","sourcesContent":["<template>\r\n  <div class=\"upload\">\r\n    <el-upload\r\n      :action=\"action\"\r\n      list-type=\"picture-card\"\r\n      :data=\"data\"\r\n      :header=\"header\"\r\n      name=\"files\"\r\n      :beforeUpload=\"beforeAvatarUpload\"\r\n      :on-preview=\"handlePictureCardPreview\"\r\n      :file-list=\"imageArr\"\r\n      :on-change=\"onChange\"\r\n      :on-success=\"onSuccess\"\r\n      :on-remove=\"onRemove\"\r\n      :limit=\"uploadLimit\"\r\n      :on-exceed=\"onExceed\"\r\n      ref=\"upload\"\r\n    >\r\n      <i class=\"el-icon-plus\"></i>\r\n    </el-upload>\r\n    <el-dialog :visible.sync=\"dialogVisible\">\r\n      <img width=\"100%\" :src=\"dialogImageUrl\" alt=\"\" />\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n<script>\r\nimport { imgUrl } from \"@/common/common\";\r\nexport default {\r\n  props: {\r\n    imageUrl: {\r\n      type: String,\r\n      default: \"\"\r\n    },\r\n    mkdir: {\r\n      type: String,\r\n      default: \"qualification\"\r\n    },\r\n    uploadLimit: {\r\n      type: Number,\r\n      default: 5\r\n    }\r\n  },\r\n  data() {\r\n    return {\r\n      imageArr: [],\r\n      data: {\r\n        mkdir: \"\"\r\n      },\r\n      urlString: \"\",\r\n      dialogVisible: false,\r\n      dialogImageUrl: \"\",\r\n      action: \"\"\r\n    };\r\n  },\r\n  watch: {\r\n    imageUrl: {\r\n      handler(newName, oldName) {\r\n        console.log(newName, this.urlString);\r\n        if (newName != this.urlString || !newName) {\r\n          this.urlString = newName;\r\n          this.imageUrl = newName;\r\n          this.init();\r\n        }\r\n      },\r\n      immediate: true,\r\n      deep: true\r\n    },\r\n    mkdir: {\r\n      handler(newName, oldName) {\r\n        this.data.mkdir = newName;\r\n      },\r\n      immediate: true\r\n    }\r\n  },\r\n  mounted() {\r\n    if (imgUrl == \"https://api.ztbory.com/dev\") {\r\n      this.data.mkdir = \"qianlei\";\r\n    }\r\n    this.action = imgUrl + \"/upload/images/\";\r\n    console.log(this.action);\r\n  },\r\n  methods: {\r\n    handlePictureCardPreview(file) {\r\n      console.log(file);\r\n      this.dialogImageUrl = file.url;\r\n      this.dialogVisible = true;\r\n    },\r\n    clearFiles() {\r\n      this.$refs[\"upload\"].clearFiles();\r\n    },\r\n    onSuccess(response, file, fileList) {\r\n      console.log(fileList);\r\n      let urlArr = [];\r\n      fileList.forEach(item => {\r\n        if (item.response) {\r\n          urlArr.push(item.response.data);\r\n        } else {\r\n          urlArr.push(item.url);\r\n        }\r\n      });\r\n      console.log(urlArr, 111);\r\n      console.log(this.imageArr, 123);\r\n      this.urlString = urlArr.join(\",\");\r\n      this.$emit(\"uploadSuccess\", urlArr);\r\n    },\r\n    onRemove(file, fileList) {\r\n      this.imageArr = fileList;\r\n      let arr = fileList.map(o => o.url);\r\n      this.urlString = arr.join(\",\");\r\n      this.$emit(\"uploadSuccess\", arr);\r\n    },\r\n    //文件超出个数限制时的钩子\r\n    onExceed() {\r\n      this.$message.warning(\"最多上传\" + this.uploadLimit + \"张图片\");\r\n    },\r\n    onChange(file, fileList) {},\r\n    header() {\r\n      let loginData = JSON.parse(localStorage.getItem(\"session\"));\r\n      let tokenParmes = loginData.token;\r\n      let header = {\r\n        Authorization: `Token ${tokenParmes}`,\r\n        \"Content-Type\": \"multipart/form-data\"\r\n      };\r\n      return header;\r\n    },\r\n    init() {\r\n      // this.imageArr = [];\r\n      if (this.imageUrl) {\r\n        let arr = this.imageUrl.split(\",\");\r\n        this.imageArr = arr.map(o => {\r\n          return {\r\n            url: o\r\n          };\r\n        });\r\n      } else {\r\n        this.imageArr = [];\r\n      }\r\n    },\r\n    beforeAvatarUpload(file) {\r\n      const isLt5M = file.size / 1024 / 1024 < 5;\r\n      if (!isLt5M) {\r\n        this.$message.error(\"上传图片大小不能超过5MB!\");\r\n        return false;\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.upload >>> .el-upload--picture-card {\r\n  width: 100px;\r\n  height: 100px;\r\n  border: 1px dashed #13c3c7;\r\n}\r\n.upload >>> .el-upload {\r\n  width: 100px;\r\n  height: 100px;\r\n  line-height: 100px;\r\n}\r\n.upload >>> .el-upload-list--picture-card .el-upload-list__item {\r\n  width: 100px;\r\n  height: 100px;\r\n  line-height: 100px;\r\n}\r\n.upload >>> .el-upload-list--picture-card .el-upload-list__item-thumbnail {\r\n  width: 100px;\r\n  height: 100px;\r\n  line-height: 100px;\r\n}\r\n.upload >>> .avatar {\r\n  width: 100px;\r\n  height: 100px;\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/upload.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"upload\"},[_c('el-upload',{ref:\"upload\",attrs:{\"action\":_vm.action,\"list-type\":\"picture-card\",\"data\":_vm.data,\"header\":_vm.header,\"name\":\"files\",\"beforeUpload\":_vm.beforeAvatarUpload,\"on-preview\":_vm.handlePictureCardPreview,\"file-list\":_vm.imageArr,\"on-change\":_vm.onChange,\"on-success\":_vm.onSuccess,\"on-remove\":_vm.onRemove,\"limit\":_vm.uploadLimit,\"on-exceed\":_vm.onExceed}},[_c('i',{staticClass:\"el-icon-plus\"})]),_vm._v(\" \"),_c('el-dialog',{attrs:{\"visible\":_vm.dialogVisible},on:{\"update:visible\":function($event){_vm.dialogVisible=$event}}},[_c('img',{attrs:{\"width\":\"100%\",\"src\":_vm.dialogImageUrl,\"alt\":\"\"}})])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-ee2539e8\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/upload.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-ee2539e8\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../node_modules/vue-loader/lib/selector?type=styles&index=0!./upload.vue\")\n}\nvar normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./upload.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./upload.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-ee2539e8\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./upload.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-ee2539e8\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/upload.vue\n// module id = null\n// module chunks = ","module.exports = { \"default\": require(\"core-js/library/fn/json/stringify\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/core-js/json/stringify.js\n// module id = mvHQ\n// module chunks = 0","var core = require('../../modules/_core');\nvar $JSON = core.JSON || (core.JSON = { stringify: JSON.stringify });\nmodule.exports = function stringify(it) { // eslint-disable-line no-unused-vars\n  return $JSON.stringify.apply($JSON, arguments);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/core-js/library/fn/json/stringify.js\n// module id = qkKv\n// module chunks = 0"],"sourceRoot":""}